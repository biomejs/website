---
import Default from "@astrojs/starlight/components/LanguageSelect.astro";
import Select from "@astrojs/starlight/components/Select.astro";
---

<Default><slot /></Default>
<version-select>
    <Select
        icon="biome"
        label="Version"
        width="fit-content"
        options={[
            { label: "v1.x", value: "v1", selected: false },
            { label: "v2.x", value: "v2", selected: true },
            { label: "next", value: "next", selected: false },
        ]}
    />
</version-select>

<script>
    class VersionSelect extends HTMLElement {
        constructor() {
            super();

            const el = this.querySelector("select");

            if (!el) return;

            const host = window.location.host;
            const subdomain = host.split(".")[0];
            if (subdomain === "next") {
                el.value = "next";
            }

            el.addEventListener("change", (e) => {
                const value = (e.currentTarget as HTMLSelectElement).value;

                const url = new URL(window.location.href);
                switch (value) {
									  case "v1":
												url.hostname = "v1.biomejs.dev";
                        break;
                    case "next":
                        url.hostname = "next.biomejs.dev";
                        break;
                    default:
                        url.hostname = "biomejs.dev";
                        break;
                }

                window.location.href = url.toString();
            });
        }
    }

    customElements.define('version-select', VersionSelect);
</script>
